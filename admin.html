<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>Admin - Menu & Ordini</title>
  <style>
    body { font-family: sans-serif; margin: 2em; }
    pre { background: #eee; padding: 1em; }
    button { font-size: 1em; }
  </style>
</head>
<body>
  <h1>Pannello Admin (Copia ordini per il ristorante)</h1>
  <div id="menuSheet"></div>

  <button onclick="copia()">Copia tutto negli appunti!</button>
  <h3>Ordini ricevuti:</h3>
  <pre id="ordiniText">Caricamento...</pre>

<script>
const URL_API = "https://script.google.com/macros/s/AKfycbwDgThhPbcLXejr62QHSE1Dg99B3kmBTefHLQlYfyjjmF5JrnjEAeyGvbCKYyvRk1wTPA/exec";

function aggiornaAdmin() {
  fetch(URL_API)
    .then(r => r.json())
    .then(dati => {
      // Mostra menu (opzionale: dalla prima cella/riga)
      document.getElementById("menuSheet").innerHTML = 
        dati.length>0
          ? "<b>Menù:</b> " + (dati[0][0] || "(Nessun menù inserito nel foglio)") 
          : "";
      // Prepara lista ordini
      let testo = '';
      for(let i=1; i<dati.length; i++) {
        if(dati[i][0]) // solo se nome valido
          testo += `${dati[i][0]}: ${dati[i][1]} (${dati[i][2]||''})\n`;
      }
      document.getElementById('ordiniText').textContent = testo.trim() ? testo : "Nessun ordine ricevuto.";
    });
}

function copia() {
  navigator.clipboard.writeText(document.getElementById('ordiniText').textContent);
  alert("Ordini copiati!");
}

aggiornaAdmin();
setInterval(aggiornaAdmin, 10000);
</script>
</body>
</html>
